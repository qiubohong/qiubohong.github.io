#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç¥ç»ç½‘ç»œè§†é¢‘éŸ³é¢‘ç”Ÿæˆè„šæœ¬
ä½¿ç”¨é€šç”¨éŸ³é¢‘ç”Ÿæˆå·¥å…·ç”Ÿæˆæ‰€æœ‰åœºæ™¯çš„éŸ³é¢‘æ–‡ä»¶
"""

import sys
from audio_generator import AudioGenerator, AudioGeneratorConfig, check_dependencies

# åœºæ™¯é…ç½®
SCENES = {
    "scene1": {
        "name": "ä»‹ç»",
        "text": "ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ ç¥ç»ç½‘ç»œç®—æ³•ã€‚ä¸€å¥è¯æ ¸å¿ƒï¼šç¥ç»ç½‘ç»œç­‰äºæ¨¡æ‹Ÿäººè„‘çš„è®¡ç®—ç½‘ç»œï¼Œé€šè¿‡å±‚å±‚ä¼ é€’æ•°æ®è‡ªåŠ¨å­¦ä¹ è§„å¾‹ï¼Œè¾“å…¥ã€åŠ å·¥ã€è¾“å‡ºæ˜¯å®ƒçš„æ ¸å¿ƒå·¥ä½œæµã€‚",
        "output_file": "scene1-audio.mp3"
    },
    "scene2": {
        "name": "å®šä¹‰",
        "text": "ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿäººå·¥ç¥ç»ç½‘ç»œï¼Œç®€ç§°ANNï¼Œæ˜¯20ä¸–çºª80å¹´ä»£ä»¥æ¥äººå·¥æ™ºèƒ½é¢†åŸŸå…´èµ·çš„ç ”ç©¶çƒ­ç‚¹ã€‚å®ƒä»ä¿¡æ¯å¤„ç†è§’åº¦å¯¹äººè„‘ç¥ç»å…ƒç½‘ç»œè¿›è¡ŒæŠ½è±¡ï¼Œå»ºç«‹æŸç§ç®€å•æ¨¡å‹ï¼ŒæŒ‰ä¸åŒçš„è¿æ¥æ–¹å¼ç»„æˆä¸åŒçš„ç½‘ç»œã€‚",
        "output_file": "scene2-audio.mp3"
    },
    "scene3": {
        "name": "ä¸‰å±‚åŠŸèƒ½",
        "text": "ç¥ç»ç½‘ç»œæœ‰ä¸‰å±‚åŠŸèƒ½ã€‚ç¬¬ä¸€ï¼Œè¾“å…¥å±‚ï¼Œæ¥æ”¶æ•°æ®ï¼Œæ¯”å¦‚28ä¹˜28åƒç´ çš„æ‰‹å†™æ•°å­—å›¾ç‰‡ã€‚ç¬¬äºŒï¼Œéšè—å±‚ï¼Œå±‚å±‚æå–ç‰¹å¾ï¼Œä»çº¿æ¡åˆ°å±€éƒ¨å›¾æ¡ˆï¼Œå†åˆ°å®Œæ•´æ•°å­—ã€‚ç¬¬ä¸‰ï¼Œè¾“å‡ºå±‚ï¼Œç»™å‡ºé¢„æµ‹ç»“æœï¼Œä¹Ÿå°±æ˜¯æ¦‚ç‡æœ€å¤§çš„æ•°å­—0åˆ°9ã€‚",
        "output_file": "scene3-audio.mp3"
    },
    "scene4": {
        "name": "æ€ä¹ˆåš",
        "text": "ç¥ç»ç½‘ç»œå¦‚ä½•å®ç°é¢„æµ‹ç»“æœå‘¢ï¼Ÿç¬¬ä¸€æ­¥ï¼Œç¥ç»å…ƒè®¡ç®—ï¼Œåƒç§¯æœ¨æ‹¼è£…ä¸€æ ·ï¼Œå°†æ‰€æœ‰æ•°æ®ã€å½±å“å› å­å’Œæƒé‡éƒ½è¾“å…¥åˆ°ç½‘ç»œä¸­ã€‚ç¬¬äºŒæ­¥ï¼Œæ¿€æ´»å‡½æ•°ï¼Œåƒè´¨æ£€å¼€å…³ï¼Œåˆ¤æ–­å½“å‰æ•°æ®è¾“å‡ºæ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ç¬¬ä¸‰æ­¥ï¼ŒæŸå¤±å‡½æ•°ï¼Œåƒè¯¯å·®é›·è¾¾ï¼Œè®¡ç®—é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹é—´çš„è¯¯å·®ã€‚ç¬¬å››æ­¥ï¼Œç»è¿‡è¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œä¸æ–­è¿­ä»£ï¼Œç›´åˆ°è¯¯å·®æœ€å°ï¼Œå¾—åˆ°é¢„æµ‹ç»“æœã€‚",
        "output_file": "scene4-audio.mp3"
    },
    "scene5": {
        "name": "ç®—æ³•ç±»å‹",
        "text": "ç¥ç»ç½‘ç»œæœ‰å››ç§ä¸»è¦ç±»å‹ã€‚å…¨è¿æ¥ç½‘ç»œï¼Œæ¯å±‚ç¥ç»å…ƒå…¨éƒ¨è¿æ¥ï¼Œå…¸å‹åº”ç”¨æ˜¯æˆ¿ä»·é¢„æµ‹ã€‚å·ç§¯ç½‘ç»œCNNï¼Œå…·æœ‰å±€éƒ¨æ„ŸçŸ¥å’Œæƒé‡å…±äº«çš„ç‰¹ç‚¹ï¼Œç”¨äºäººè„¸è¯†åˆ«ã€‚å¾ªç¯ç½‘ç»œRNNï¼Œèƒ½è®°å¿†ä¹‹å‰çš„çŠ¶æ€ï¼Œåº”ç”¨äºè¯­éŸ³è¯†åˆ«ã€‚è¿˜æœ‰Transformerï¼Œé‡‡ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå°±æ˜¯ChatGPTä½¿ç”¨çš„æŠ€æœ¯ã€‚",
        "output_file": "scene5-audio.mp3"
    },
    "scene6": {
        "name": "ç”Ÿæ´»æ¡ˆä¾‹",
        "text": "æˆ‘ä»¬ç”¨å¿«é€’åˆ†æ‹£ä¸­å¿ƒæ¥ç±»æ¯”ç¥ç»ç½‘ç»œã€‚æ”¶è´§åŒºå°±æ˜¯è¾“å…¥å±‚ï¼Œæ¥æ”¶å…¨å›½çš„åŒ…è£¹ï¼Œä¹Ÿå°±æ˜¯åŸå§‹æ•°æ®ã€‚åˆ†æ‹£çº¿å°±æ˜¯éšè—å±‚ï¼Œé¦–ç«™æŒ‰çœä»½ç²—åˆ†ï¼Œæå–å¤§ç‰¹å¾ï¼›ä¸­è½¬æŒ‰åŸå¸‚ç»†åˆ†ï¼Œè¯†åˆ«å±€éƒ¨ç‰¹å¾ï¼›æœ«ç«™æŒ‰è¡—é“ç²¾åˆ†ï¼Œç¡®è®¤ç»†èŠ‚ã€‚å‘è´§åŒºå°±æ˜¯è¾“å‡ºå±‚ï¼Œé€è‡³å…·ä½“åœ°å€ï¼Œå¾—åˆ°åˆ†ç±»ç»“æœã€‚",
        "output_file": "scene6-audio.mp3"
    },
    "scene7": {
        "name": "å†·çŸ¥è¯†",
        "text": "æœ€ååˆ†äº«ä¸€ä¸ªå†·çŸ¥è¯†ã€‚GPT-3çš„ç¥ç»å…ƒæ•°é‡æ˜¯1750äº¿ï¼Œå¤§çº¦æ˜¯äººç±»å¤§è„‘ç¥ç»å…ƒ860äº¿çš„2å€ã€‚ä½†æ˜¯ï¼Œäººè„‘èƒ½è€—ä»…20ç“¦ï¼Œè€Œè®­ç»ƒGPT-3éœ€è¦190ä¸‡åº¦ç”µï¼Œç›¸å½“äº200ä¸ªå®¶åº­çš„å¹´ç”¨ç”µé‡ï¼",
        "output_file": "scene7-audio.mp3"
    }
}


def main():
    """ç”Ÿæˆæ‰€æœ‰åœºæ™¯çš„éŸ³é¢‘æ–‡ä»¶"""
    
    print("=" * 60)
    print("ç¥ç»ç½‘ç»œè§†é¢‘éŸ³é¢‘ç”Ÿæˆå·¥å…·")
    print("=" * 60)
    print("ğŸ¤– ä½¿ç”¨Qwen3-TTSæ¨¡å‹ç”Ÿæˆé«˜è´¨é‡è¯­éŸ³è§£è¯´")
    print("ğŸ¯ æ–‡æœ¬æ¨¡å¼ï¼šç›´æ¥ä»é…ç½®çš„æ–‡æœ¬ç”ŸæˆéŸ³é¢‘")
    print("=" * 60)
    
    # æ£€æŸ¥ä¾èµ–
    if not check_dependencies():
        sys.exit(1)
    
    # åˆ›å»ºé…ç½®
    config = AudioGeneratorConfig(
        video_name="NeuralNetworkVideo",
        output_dir="public/NeuralNetworkVideo",
        model_path="./Qwen3-TTS-12Hz-1.7B-Base",
        reference_audio="./borfy.mp3",
        mode="text"  # æ–‡æœ¬æ¨¡å¼
    )
    
    # åˆ›å»ºç”Ÿæˆå™¨
    generator = AudioGenerator(config)
    
    # ç”ŸæˆéŸ³é¢‘
    success_count, skipped_count, failed_count = generator.generate_from_config(SCENES)
    
    # è¾“å‡ºç»“æœ
    print(f"\nğŸ“Š ç”Ÿæˆç»“æœ:")
    print(f"   æ€»åœºæ™¯æ•°: {len(SCENES)}")
    print(f"   æˆåŠŸå¤„ç†: {success_count}/{len(SCENES)}")
    print(f"   ä½¿ç”¨å·²å­˜åœ¨éŸ³é¢‘: {skipped_count}")
    print(f"   æ–°ç”ŸæˆéŸ³é¢‘: {success_count - skipped_count}")
    print(f"   å¤±è´¥: {failed_count}")
    
    if success_count == len(SCENES):
        print("\nğŸ‰ æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼")
        print(f"ğŸ“ éŸ³é¢‘æ–‡ä»¶ä½ç½®: {config.output_dir}/")
        if skipped_count > 0:
            print(f"ğŸ’¡ è·³è¿‡äº† {skipped_count} ä¸ªå·²å­˜åœ¨çš„éŸ³é¢‘æ–‡ä»¶")
        print("\nä¸‹ä¸€æ­¥:")
        print("1. æ£€æŸ¥ç”Ÿæˆçš„éŸ³é¢‘æ–‡ä»¶")
        print("2. è¿è¡Œ 'npm run dev' é¢„è§ˆè§†é¢‘")
        print("3. è¿è¡Œ 'npm run render NeuralNetworkVideo' æ¸²æŸ“è§†é¢‘")
        sys.exit(0)
    else:
        print("\nâš ï¸  éƒ¨åˆ†éŸ³é¢‘ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯")
        sys.exit(1)


if __name__ == "__main__":
    main()