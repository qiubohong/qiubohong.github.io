# 无监督学习视频时长更新说明

## 更新日期
2026-02-10

## 更新内容
根据实际生成的音频文件时长，已更新所有场景的视频时长，确保视频、音频和字幕完美同步。

## ⚠️ 重要规则
**每个场景都增加30帧（1秒）的缓冲时间**，确保：
1. 声音能够完整播放
2. 给观看用户足够的反应和理解时间
3. 场景切换更加自然流畅

**计算公式**: `场景帧数 = (音频时长秒数 × 30) + 30帧缓冲`

## 场景时长详情

| 场景 | 描述 | 音频时长 | 音频帧数 | 缓冲帧数 | 最终帧数 | 最终时长 |
|------|------|----------|----------|----------|----------|----------|
| Scene 1 | 介绍 | 8.72秒 | 262帧 | +30帧 | **292帧** | **9.73秒** |
| Scene 2 | 定义 | 10.88秒 | 326帧 | +30帧 | **356帧** | **11.87秒** |
| Scene 3 | 三种方法概览 | 8.48秒 | 254帧 | +30帧 | **284帧** | **9.47秒** |
| Scene 4 | 聚类详解 | 15.28秒 | 458帧 | +30帧 | **488帧** | **16.27秒** |
| Scene 5 | 降维详解 | 14.4秒 | 432帧 | +30帧 | **462帧** | **15.4秒** |
| Scene 6 | 关联详解 | 14.8秒 | 444帧 | +30帧 | **474帧** | **15.8秒** |
| Scene 7 | 动手实验 | 11.36秒 | 341帧 | +30帧 | **371帧** | **12.37秒** |
| Scene 8 | 实际案例 | 12.4秒 | 372帧 | +30帧 | **402帧** | **13.4秒** |
| Scene 9 | 结尾收尾 | 6秒 | 180帧 | 0帧 | **180帧** | **6秒** |

## 转场时长

所有转场效果保持不变：
- 转场1: 淡出效果 - 20帧
- 转场2: 从左侧滑动 - 25帧
- 转场3: 擦除效果 - 15帧
- 转场4: 翻转效果 - 30帧
- 转场5: 从顶部滑动 - 20帧
- 转场6: 从右侧滑动 - 22帧
- 转场7: 淡入淡出效果 - 30帧
- 转场8: 淡入淡出效果 - 30帧

**转场总时长**: 192帧 (6.4秒)

## 总视频时长计算

### 场景总时长（含缓冲）
- 9.73 + 11.87 + 9.47 + 16.27 + 15.4 + 15.8 + 12.37 + 13.4 + 6 = **110.31秒**
- 总帧数: 292 + 356 + 284 + 488 + 462 + 474 + 371 + 402 + 180 = **3309帧**

### 转场总时长
- 6.4秒 (192帧)

### 视频总时长
- **116.71秒** (约1分57秒)
- **3501帧** (30fps)

### 缓冲时间说明
- 每个场景增加30帧（1秒）缓冲
- 8个场景共增加240帧（8秒）
- 缓冲时间让音频播放更完整，用户体验更好

## 更新的文件

1. **UnsupervisedLearningVideo.tsx**
   - 更新了所有8个场景的 `durationInFrames` 参数
   - 已添加所有场景的音频播放组件 (`Html5Audio`)
   - 字幕组件 (`CaptionComponent`) 已配置完成

2. **字幕文件** (已由 tts_unsupervised.py 自动更新)
   - scene1-captions.json
   - scene2-captions.json
   - scene3-captions.json
   - scene4-captions.json
   - scene5-captions.json
   - scene6-captions.json
   - scene7-captions.json
   - scene8-captions.json

## 音频文件位置

所有音频文件位于：`public/UnsupervisedLearningVideo/`
- scene1-audio.mp3
- scene2-audio.mp3
- scene3-audio.mp3
- scene4-audio.mp3
- scene5-audio.mp3
- scene6-audio.mp3
- scene7-audio.mp3
- scene8-audio.mp3

## 预览和渲染

### 预览视频
```bash
npm run preview
```

### 渲染视频
```bash
npm run render -- UnsupervisedLearningVideo
```

## 技术细节

### 帧率计算
- 视频帧率: 30fps
- 计算公式: **场景帧数 = (音频秒数 × 30) + 30帧缓冲**
- 示例: 8.72秒 × 30 + 30 = 262 + 30 = 292帧

### 缓冲规则 ⭐
- **每个场景增加30帧（1秒）缓冲时间**
- 目的：
  1. 确保音频完整播放
  2. 给用户足够的反应时间
  3. 场景切换更自然
- 适用范围：所有带音频的场景
- 后续所有视频都应遵循此规则

### 音频同步
- 每个场景的音频文件通过 `Html5Audio` 组件播放
- 字幕通过 `CaptionComponent` 组件显示
- 字幕时间戳与音频完美同步（由 tts_unsupervised.py 自动生成）
- 音频播放完毕后有1秒缓冲时间

### 音量设置
- 所有场景音频音量设置为 0.8 (80%)
- 可根据需要在 UnsupervisedLearningVideo.tsx 中调整

## 注意事项

1. **字幕时间戳**: 所有字幕的时间戳都是相对于场景开始时间（startTimeMs=0）
2. **音频文件**: 确保所有音频文件都存在于 `public/UnsupervisedLearningVideo/` 目录
3. **转场效果**: 转场时长不计入场景时长，是额外添加的
4. **结尾场景**: 使用的是通用的结尾音频和字幕文件（scene8-ending.mp3）

## 下一步

视频已准备就绪，可以：
1. 运行 `npm run preview` 预览效果
2. 运行 `npm run render -- UnsupervisedLearningVideo` 渲染最终视频
3. 根据需要调整音量、转场效果或其他参数
